<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MOTOR Dashboard - Test Results 100% PASS</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #1e1e1e 0%, #2d2d30 100%);
      color: #e0e0e0;
      padding: 20px;
      min-height: 100vh;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
    }

    .header {
      text-align: center;
      margin-bottom: 40px;
      padding-bottom: 30px;
      border-bottom: 2px solid #007acc;
    }

    .header h1 {
      font-size: 2.5em;
      color: #00d4ff;
      margin-bottom: 10px;
      text-shadow: 0 2px 10px rgba(0, 212, 255, 0.3);
    }

    .header p {
      color: #b0b0b0;
      font-size: 1.1em;
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      margin-bottom: 35px;
    }

    .stat-card {
      background: linear-gradient(135deg, #1e1e1e 0%, #2d2d30 100%);
      border: 2px solid #007acc;
      border-radius: 8px;
      padding: 20px;
      text-align: center;
      transition: all 0.3s ease;
    }

    .stat-card:hover {
      border-color: #00d4ff;
      box-shadow: 0 0 20px rgba(0, 212, 255, 0.3);
      transform: translateY(-5px);
    }

    .stat-label {
      color: #b0b0b0;
      font-size: 0.9em;
      text-transform: uppercase;
      letter-spacing: 1px;
      margin-bottom: 8px;
    }

    .stat-value {
      font-size: 2em;
      font-weight: bold;
      color: #00d4ff;
    }

    .filters {
      display: flex;
      gap: 10px;
      margin-bottom: 30px;
      flex-wrap: wrap;
    }

    .filter-btn {
      background: #2d2d30;
      border: 1px solid #007acc;
      color: #e0e0e0;
      padding: 10px 20px;
      border-radius: 4px;
      cursor: pointer;
      transition: all 0.3s;
      font-size: 0.95em;
      font-weight: 500;
    }

    .filter-btn:hover {
      background: #007acc;
      border-color: #00d4ff;
    }

    .filter-btn.active {
      background: #007acc;
      border-color: #00d4ff;
      color: #ffffff;
      box-shadow: 0 0 10px rgba(0, 212, 255, 0.5);
    }

    .routes-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(420px, 1fr));
      gap: 20px;
      margin-top: 30px;
    }

    .route-card {
      background: linear-gradient(135deg, #252526 0%, #2d2d30 100%);
      border: 1px solid #3e3e42;
      border-radius: 8px;
      padding: 20px;
      transition: all 0.3s ease;
      display: none;
    }

    .route-card.show {
      display: block;
    }

    .route-card:hover {
      border-color: #007acc;
      box-shadow: 0 0 20px rgba(0, 212, 255, 0.2);
      transform: translateY(-5px);
    }

    .route-header {
      display: flex;
      justify-content: space-between;
      align-items: start;
      margin-bottom: 15px;
      padding-bottom: 15px;
      border-bottom: 1px solid #3e3e42;
    }

    .route-title {
      flex: 1;
    }

    .route-name {
      font-size: 1.2em;
      font-weight: bold;
      color: #00d4ff;
      margin-bottom: 5px;
    }

    .route-id {
      font-size: 0.8em;
      color: #b0b0b0;
    }

    .route-badges {
      display: flex;
      gap: 8px;
    }

    .badge {
      padding: 4px 12px;
      border-radius: 4px;
      font-size: 0.8em;
      font-weight: 600;
      text-transform: uppercase;
    }

    .badge.tier {
      background: rgba(0, 212, 255, 0.2);
      border: 1px solid #00d4ff;
      color: #00d4ff;
    }

    .badge.status {
      background: rgba(0, 255, 136, 0.2);
      border: 1px solid #00ff88;
      color: #00ff88;
    }

    .route-locations {
      margin-bottom: 15px;
      font-size: 0.95em;
    }

    .location-row {
      display: flex;
      align-items: center;
      margin: 5px 0;
    }

    .location-row strong {
      color: #00d4ff;
      min-width: 60px;
    }

    .location-row .icon {
      margin-right: 8px;
      font-size: 1.2em;
    }

    .metrics-table {
      width: 100%;
      margin-bottom: 15px;
      border-collapse: collapse;
      font-size: 0.95em;
    }

    .metrics-table tr {
      border-bottom: 1px solid #3e3e42;
    }

    .metrics-table td {
      padding: 8px 0;
      color: #b0b0b0;
    }

    .metrics-table td:first-child {
      color: #e0e0e0;
      font-weight: 500;
    }

    .metrics-table td:last-child {
      text-align: right;
      color: #00d4ff;
      font-weight: 600;
    }

    .stages-section {
      margin-bottom: 15px;
    }

    .stages-label {
      color: #e0e0e0;
      font-weight: 600;
      margin-bottom: 10px;
      font-size: 0.95em;
    }

    .stage {
      background: rgba(0, 212, 255, 0.05);
      border-left: 3px solid #007acc;
      padding: 8px 12px;
      margin-bottom: 8px;
      border-radius: 4px;
      font-size: 0.9em;
      color: #b0b0b0;
    }

    .stage strong {
      color: #00d4ff;
    }

    .action-buttons {
      display: flex;
      gap: 10px;
      margin-top: 15px;
    }

    .action-btn {
      flex: 1;
      padding: 10px;
      border: 1px solid #007acc;
      background: #2d2d30;
      color: #00d4ff;
      border-radius: 4px;
      cursor: pointer;
      font-weight: 600;
      font-size: 0.9em;
      transition: all 0.3s;
      text-decoration: none;
      text-align: center;
    }

    .action-btn:hover {
      background: #007acc;
      box-shadow: 0 0 10px rgba(0, 212, 255, 0.5);
    }

    .status-pass {
      color: #00ff88;
      font-weight: 600;
    }

    .difficulty-HIGH {
      color: #ff6b6b;
      font-weight: 600;
    }

    .difficulty-MEDIUM {
      color: #ffd700;
      font-weight: 600;
    }

    .difficulty-LOW {
      color: #00ff88;
      font-weight: 600;
    }

    .difficulty-EXTREME {
      color: #ff1744;
      font-weight: 600;
    }

    .waypoints-section {
      background: rgba(0, 212, 255, 0.05);
      padding: 10px;
      border-radius: 4px;
      margin-bottom: 15px;
      font-size: 0.9em;
      border-left: 3px solid #00d4ff;
    }

    .waypoints-section strong {
      color: #00d4ff;
    }

    .no-routes {
      text-align: center;
      padding: 40px;
      color: #b0b0b0;
      font-size: 1.1em;
    }

    .footer {
      text-align: center;
      margin-top: 50px;
      padding-top: 30px;
      border-top: 1px solid #3e3e42;
      color: #b0b0b0;
      font-size: 0.9em;
    }

    @media (max-width: 768px) {
      .routes-grid {
        grid-template-columns: 1fr;
      }

      .header h1 {
        font-size: 1.8em;
      }

      .filters {
        flex-direction: column;
      }

      .filter-btn {
        width: 100%;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>üß™ MOTOR Dashboard - Test Results</h1>
      <p>Validaci√≥n completa del motor de c√°lculo de rutas - 16 Rutas, 100% PASS ‚úÖ</p>
    </div>

    <div class="stats-grid">
      <div class="stat-card">
        <div class="stat-label">Total Rutas</div>
        <div class="stat-value" id="totalRoutes">16</div>
      </div>
      <div class="stat-card">
        <div class="stat-label">Tasa de √âxito</div>
        <div class="stat-value">100%</div>
      </div>
      <div class="stat-card">
        <div class="stat-label">Distancia Total</div>
        <div class="stat-value" id="totalDistance">17,325km</div>
      </div>
      <div class="stat-card">
        <div class="stat-label">D√≠as Totales</div>
        <div class="stat-value" id="totalDays">90</div>
      </div>
    </div>

    <div class="filters">
      <button class="filter-btn active" onclick="filterRoutes('ALL')">Todas (16)</button>
      <button class="filter-btn" onclick="filterRoutes('MOUNTAIN')">Monta√±a</button>
      <button class="filter-btn" onclick="filterRoutes('CROSS-CONTINENT')">Trans-Continental</button>
      <button class="filter-btn" onclick="filterRoutes('SMALL_TOWNS')">Pueblos Peque√±os</button>
      <button class="filter-btn" onclick="filterRoutes('EXTREME')">Extrema</button>
      <button class="filter-btn" onclick="filterRoutes('COMPLEX')">Compleja</button>
    </div>

    <div class="routes-grid" id="routesContainer"></div>

    <div class="footer">
      <p>‚úÖ Todos los tests pasaron exitosamente. Bug de c√°lculo de distancias corregido.</p>
      <p style="margin-top: 10px; font-size: 0.85em; color: #666;">Generado: 2025-12-08 - Fix: line 402-407 app/actions.ts</p>
    </div>
  </div>

  <script>
    // Datos reales del test - JSON actual del archivo
    const testData = {
      "summary": {
        "testType": "MOTOR REAL API - 16 ROUTES VALIDATION",
        "generatedAt": "2025-12-08T13:48:36.387Z",
        "totalTests": 16,
        "passed": 16,
        "failed": 0,
        "passRate": 100,
        "totalDistance": 17325.073000000004,
        "totalDays": 90
      },
      "routes": [
        {"id": 1, "tier": "MOUNTAIN", "name": "Alpine Crossing (Suiza)", "origin": "Zurich, Switzerland", "destination": "Chamonix, France", "waypoints": [], "distanceKm": 294.38, "actualDays": 3, "difficulty": "HIGH", "stages": [{"day": 1, "from": "Zurich, Switzerland", "to": "Chamonix, France", "distance": 294.38}, {"day": 2, "from": "Chamonix-Mont-Blanc", "to": "Chamonix-Mont-Blanc", "distance": 0}, {"day": 3, "from": "Chamonix-Mont-Blanc", "to": "Chamonix-Mont-Blanc", "distance": 0}]},
        {"id": 2, "tier": "MOUNTAIN", "name": "Pyrenees North Slope", "origin": "Barcelona, Spain", "destination": "Saint-Jean-de-Luz, France", "waypoints": [], "distanceKm": 594.766, "actualDays": 2, "difficulty": "HIGH", "stages": [{"day": 1, "from": "Barcelona, Spain", "to": "Huesca", "distance": 300}, {"day": 2, "from": "Huesca", "to": "Saint-Jean-de-Luz, France", "distance": 294.766}]},
        {"id": 3, "tier": "MOUNTAIN", "name": "Norway Fjords", "origin": "Oslo, Norway", "destination": "Geirangerfjord, Norway", "waypoints": [], "distanceKm": 573.472, "actualDays": 3, "difficulty": "HIGH", "stages": [{"day": 1, "from": "Oslo, Norway", "to": "Vestre Slidre", "distance": 300}, {"day": 2, "from": "Vestre Slidre", "to": "Geirangerfjord, Norway", "distance": 273.472}, {"day": 3, "from": "Geiranger", "to": "Geiranger", "distance": 0}]},
        {"id": 4, "tier": "MOUNTAIN", "name": "Trans-Balkans", "origin": "Belgrade, Serbia", "destination": "Kotor, Montenegro", "waypoints": [], "distanceKm": 540.54, "actualDays": 3, "difficulty": "HIGH", "stages": [{"day": 1, "from": "Belgrade, Serbia", "to": "Pribojska Gole≈°a", "distance": 300}, {"day": 2, "from": "Pribojska Gole≈°a", "to": "Kotor, Montenegro", "distance": 240.54}, {"day": 3, "from": "Kotor", "to": "Kotor", "distance": 0}]},
        {"id": 5, "tier": "MOUNTAIN", "name": "Alpine Loop", "origin": "Salzburg, Austria", "destination": "Salzburg, Austria", "waypoints": ["Innsbruck, Austria"], "distanceKm": 378.027, "actualDays": 2, "difficulty": "HIGH", "stages": [{"day": 1, "from": "Salzburg, Austria", "to": "Innsbruck, Austria", "distance": 188.609}, {"day": 2, "from": "Innsbruck, Austria", "to": "Salzburg, Austria", "distance": 189.418}]},
        {"id": 6, "tier": "MOUNTAIN", "name": "Scottish Highlands", "origin": "Edinburgh, Scotland", "destination": "Isle of Skye, Scotland", "waypoints": [], "distanceKm": 365.531, "actualDays": 3, "difficulty": "HIGH", "stages": [{"day": 1, "from": "Edinburgh, Scotland", "to": "Highland", "distance": 300}, {"day": 2, "from": "Highland", "to": "Isle of Skye, Scotland", "distance": 65.531}, {"day": 3, "from": "Highland", "to": "Highland", "distance": 0}]},
        {"id": 7, "tier": "CROSS-CONTINENT", "name": "Western Europe Grand Tour", "origin": "London, United Kingdom", "destination": "Rome, Italy", "waypoints": ["Paris, France", "Geneva, Switzerland"], "distanceKm": 1954.78, "actualDays": 9, "difficulty": "HIGH", "stages": [{"day": 1, "from": "London, United Kingdom", "to": "Fesques", "distance": 300}, {"day": 2, "from": "Fesques", "to": "Paris, France", "distance": 159.615}, {"day": 3, "from": "Paris, France", "to": "Saint-Thibault", "distance": 300}, {"day": 4, "from": "Saint-Thibault", "to": "Geneva, Switzerland", "distance": 240.465}, {"day": 5, "from": "Geneva, Switzerland", "to": "Asti", "distance": 300}, {"day": 6, "from": "Asti", "to": "Punto en Ruta", "distance": 300}, {"day": 7, "from": "Punto en Ruta", "to": "Roma", "distance": 300}, {"day": 8, "from": "Roma", "to": "Rome, Italy", "distance": 54.7}, {"day": 9, "from": "Roma", "to": "Roma", "distance": 0}]},
        {"id": 8, "tier": "CROSS-CONTINENT", "name": "Eastern Europe Deep Dive", "origin": "Warsaw, Poland", "destination": "Istanbul, Turkey", "waypoints": ["Budapest, Hungary", "Belgrade, Serbia"], "distanceKm": 2184.098, "actualDays": 10, "difficulty": "HIGH", "stages": [{"day": 1, "from": "Warsaw, Poland", "to": "Jƒôdrzej√≥w County", "distance": 300}, {"day": 2, "from": "Jƒôdrzej√≥w County", "to": "Brezno", "distance": 300}, {"day": 3, "from": "Brezno", "to": "Budapest, Hungary", "distance": 258.285}, {"day": 4, "from": "Budapest, Hungary", "to": "≈Ωabalj", "distance": 300}, {"day": 5, "from": "≈Ωabalj", "to": "Belgrade, Serbia", "distance": 79.431}, {"day": 6, "from": "Belgrade, Serbia", "to": "Medkovets", "distance": 300}, {"day": 7, "from": "Medkovets", "to": "Stara Zagora", "distance": 300}, {"day": 8, "from": "Stara Zagora", "to": "Nakka≈ü", "distance": 300}, {"day": 9, "from": "Nakka≈ü", "to": "Istanbul, Turkey", "distance": 46.382}, {"day": 10, "from": "Estambul", "to": "Estambul", "distance": 0}]},
        {"id": 9, "tier": "CROSS-CONTINENT", "name": "Mediterranean Coast", "origin": "Barcelona, Spain", "destination": "Athens, Greece", "waypoints": ["Nice, France", "Rome, Italy"], "distanceKm": 2591.267, "actualDays": 12, "difficulty": "HIGH", "stages": [{"day": 1, "from": "Barcelona, Spain", "to": "Punto en Ruta", "distance": 300}, {"day": 2, "from": "Punto en Ruta", "to": "Fr√©jus", "distance": 300}, {"day": 3, "from": "Fr√©jus", "to": "Nice, France", "distance": 61.68}, {"day": 4, "from": "Nice, France", "to": "Punto en Ruta", "distance": 300}, {"day": 5, "from": "Punto en Ruta", "to": "Roma", "distance": 300}, {"day": 6, "from": "Roma", "to": "Rome, Italy", "distance": 93.918}, {"day": 7, "from": "Rome, Italy", "to": "Avellino", "distance": 300}, {"day": 8, "from": "Avellino", "to": "Punto en Ruta", "distance": 300}, {"day": 9, "from": "Punto en Ruta", "to": "Punto en Ruta", "distance": 300}, {"day": 10, "from": "Punto en Ruta", "to": "√Åtica", "distance": 300}, {"day": 11, "from": "√Åtica", "to": "Athens, Greece", "distance": 35.669}, {"day": 12, "from": "Atenas", "to": "Atenas", "distance": 0}]},
        {"id": 10, "tier": "SMALL_TOWNS", "name": "Tuscany Wine Route", "origin": "Montepulciano, Italy", "destination": "Volterra, Italy", "waypoints": ["Montalcino, Italy"], "distanceKm": 129.733, "actualDays": 2, "difficulty": "LOW", "stages": [{"day": 1, "from": "Montepulciano, Italy", "to": "Montalcino, Italy", "distance": 35.987}, {"day": 2, "from": "Montalcino, Italy", "to": "Volterra, Italy", "distance": 93.746}]},
        {"id": 11, "tier": "SMALL_TOWNS", "name": "Cotswolds Circuit", "origin": "Bourton-on-the-Water, England", "destination": "Winchcombe, England", "waypoints": ["Chipping Campden, England"], "distanceKm": 47.538, "actualDays": 2, "difficulty": "LOW", "stages": [{"day": 1, "from": "Bourton-on-the-Water, England", "to": "Chipping Campden, England", "distance": 22.326}, {"day": 2, "from": "Chipping Campden, England", "to": "Winchcombe, England", "distance": 25.212}]},
        {"id": 12, "tier": "SMALL_TOWNS", "name": "Loire Valley Towns", "origin": "Amboise, France", "destination": "Chenonceaux, France", "waypoints": ["Montrichard, France"], "distanceKm": 26.985, "actualDays": 2, "difficulty": "LOW", "stages": [{"day": 1, "from": "Amboise, France", "to": "Montrichard, France", "distance": 18.077}, {"day": 2, "from": "Montrichard, France", "to": "Chenonceaux, France", "distance": 8.908}]},
        {"id": 13, "tier": "EXTREME", "name": "Across Turkey", "origin": "Istanbul, Turkey", "destination": "Cappadocia, Turkey", "waypoints": ["Ankara, Turkey"], "distanceKm": 750.968, "actualDays": 5, "difficulty": "EXTREME", "stages": [{"day": 1, "from": "Istanbul, Turkey", "to": "Nallƒ±han", "distance": 300}, {"day": 2, "from": "Nallƒ±han", "to": "Ankara, Turkey", "distance": 144.782}, {"day": 3, "from": "Ankara, Turkey", "to": "Nev≈üehir", "distance": 300}, {"day": 4, "from": "Nev≈üehir", "to": "Cappadocia, Turkey", "distance": 6.186}, {"day": 5, "from": "Avanos", "to": "Avanos", "distance": 0}]},
        {"id": 14, "tier": "EXTREME", "name": "North Africa Desert", "origin": "Fez, Morocco", "destination": "Merzouga, Morocco", "waypoints": [], "distanceKm": 462.004, "actualDays": 3, "difficulty": "EXTREME", "stages": [{"day": 1, "from": "Fez, Morocco", "to": "Provincia de Errachid√≠a", "distance": 300}, {"day": 2, "from": "Provincia de Errachid√≠a", "to": "Merzouga, Morocco", "distance": 162.004}, {"day": 3, "from": "Merzouga", "to": "Merzouga", "distance": 0}]},
        {"id": 15, "tier": "COMPLEX", "name": "European Tech Hub Tour", "origin": "Lisbon, Portugal", "destination": "Budapest, Hungary", "waypoints": ["Dublin, Ireland", "Berlin, Germany", "Prague, Czech Republic"], "distanceKm": 5338.34, "actualDays": 24, "difficulty": "HIGH", "stages": [{"day": 1, "from": "Lisbon, Portugal", "to": "Figueira da Foz", "distance": 300}, {"day": 2, "from": "Figueira da Foz", "to": "Bico", "distance": 300}, {"day": 3, "from": "Bico", "to": "Punto en Ruta", "distance": 300}, {"day": 10, "from": "Condado Wicklow", "to": "Dublin, Ireland", "distance": 77}, {"day": 16, "from": "Kl√∂tze", "to": "Berlin, Germany", "distance": 189.532}, {"day": 17, "from": "Berlin, Germany", "to": "Prague, Czech Republic", "distance": 347.013}, {"day": 19, "from": "Borsk√Ω", "to": "Budapest, Hungary", "distance": 224.795}]},
        {"id": 16, "tier": "COMPLEX", "name": "Wine Tourism Circuit", "origin": "Bordeaux, France", "destination": "Avignon, France", "waypoints": ["Dijon, France", "Lyon, France"], "distanceKm": 1092.644, "actualDays": 5, "difficulty": "HIGH", "stages": [{"day": 1, "from": "Bordeaux, France", "to": "Chavanat", "distance": 300}, {"day": 2, "from": "Chavanat", "to": "Vi√©vy", "distance": 300}, {"day": 3, "from": "Vi√©vy", "to": "Dijon, France", "distance": 68.93}, {"day": 4, "from": "Dijon, France", "to": "Lyon, France", "distance": 195.318}, {"day": 5, "from": "Lyon, France", "to": "Avignon, France", "distance": 228.396}]}
      ]
    };

    let currentFilter = 'ALL';

    function renderRoutes() {
      const container = document.getElementById('routesContainer');
      
      container.innerHTML = testData.routes.map(route => {
        const waypointsHtml = route.waypoints.length > 0
          ? `<div class="waypoints-section"><strong>üö© Paradas:</strong> ${route.waypoints.join(' ‚Üí ')}</div>`
          : '';

        const stagesHtml = route.stages
          .map(s => `<div class="stage"><strong>D√≠a ${s.day}:</strong> ${s.from} ‚Üí ${s.to} (${s.distance}km)</div>`)
          .join('');

        return `
          <div class="route-card" data-tier="${route.tier}">
            <div class="route-header">
              <div class="route-title">
                <div class="route-id">Test #${route.id}</div>
                <div class="route-name">${route.name}</div>
              </div>
              <div class="route-badges">
                <span class="badge tier">${route.tier}</span>
                <span class="badge status">PASS ‚úÖ</span>
              </div>
            </div>

            <div class="route-locations">
              <div class="location-row">
                <span class="icon">üìç</span>
                <strong>Salida:</strong>
                <span>${route.origin}</span>
              </div>
              <div class="location-row">
                <span class="icon">üéØ</span>
                <strong>Destino:</strong>
                <span>${route.destination}</span>
              </div>
            </div>

            ${waypointsHtml}

            <table class="metrics-table">
              <tr>
                <td>Distancia</td>
                <td>${route.distanceKm.toFixed(2)} km</td>
              </tr>
              <tr>
                <td>Duraci√≥n</td>
                <td>${route.actualDays} d√≠a${route.actualDays !== 1 ? 's' : ''}</td>
              </tr>
              <tr>
                <td>Dificultad</td>
                <td><span class="difficulty-${route.difficulty}">${route.difficulty}</span></td>
              </tr>
              <tr>
                <td>Resultado</td>
                <td><span class="status-pass">‚úÖ PASS</span></td>
              </tr>
            </table>

            <div class="stages-section">
              <div class="stages-label">üìã Itinerario Detallado</div>
              ${stagesHtml}
            </div>

            <div class="action-buttons">
              <a href="https://maps.google.com/maps?q=${encodeURIComponent(route.origin)}+to+${encodeURIComponent(route.destination)}" 
                 target="_blank" class="action-btn">üó∫Ô∏è Google Maps</a>
              <button class="action-btn" onclick="openMotorWithData(${JSON.stringify(route).replace(/"/g, '&quot;')})">üöó Abrir MOTOR</button>
            </div>
            <div style="background: rgba(0, 212, 255, 0.1); border: 1px solid #007acc; border-radius: 4px; padding: 10px; margin-top: 10px; font-size: 0.85em; color: #b0b0b0;">
              <strong style="color: #00d4ff;">üìã Datos del test:</strong><br>
              ${route.waypoints.length > 0 ? `‚úì ${route.waypoints.length} parada${route.waypoints.length > 1 ? 's' : ''}<br>` : ''}
              ‚úì ${Math.max(0, route.actualDays - route.stages.filter(s => s.distance > 0).length)} d√≠a${Math.max(0, route.actualDays - route.stages.filter(s => s.distance > 0).length) !== 1 ? 's' : ''} de descanso
              <br><small style="color: #666; margin-top: 5px; display: block;">Al abrir MOTOR, todo estar√° precargado</small>
            </div>
          </div>
        `;
      }).join('');

      filterRoutes(currentFilter);
    }

    function filterRoutes(tier) {
      currentFilter = tier;
      document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
      event.target?.classList.add('active');

      const cards = document.querySelectorAll('.route-card');
      const filtered = tier === 'ALL' 
        ? cards 
        : Array.from(cards).filter(card => card.dataset.tier === tier);

      cards.forEach(card => card.classList.remove('show'));
      filtered.forEach(card => card.classList.add('show'));

      if (filtered.length === 0) {
        document.getElementById('routesContainer').innerHTML = 
          '<div class="no-routes">No se encontraron rutas para este filtro.</div>';
      }
    }

    function openMotor(routeId, origin, destination, waypoints, actualDays) {
      // Obtener la ruta para acceder a los datos
      const route = testData.routes.find(r => r.id === routeId);
      
      // Calcular d√≠as de conducci√≥n vs descanso
      const drivingDays = route.stages.filter(s => s.distance > 0).length;
      const restDays = actualDays - drivingDays;
      
      // Mostrar instrucciones antes de abrir
      if (restDays > 0) {
        alert(`‚ö†Ô∏è IMPORTANTE:\n\n1. MOTOR se abrir√° con los datos precargados\n2. Debes AGREGAR ${restDays} d√≠a${restDays > 1 ? 's' : ''} de descanso en "${destination}"\n3. Luego haz clic en "Calcular"\n\nEsta ruta tiene ${drivingDays} d√≠a${drivingDays > 1 ? 's' : ''} de conducci√≥n + ${restDays} de descanso = ${actualDays} d√≠as totales`);
      }
      
      // Construir URL con par√°metros
      const waypointStr = waypoints && waypoints !== '' 
        ? `&waypoints=${encodeURIComponent(waypoints)}` 
        : '';
      const url = `http://localhost:3000/motor?origin=${encodeURIComponent(origin)}&destination=${encodeURIComponent(destination)}${waypointStr}`;
      window.open(url, '_blank');
    }

    function copyToClipboard(data, routeName) {
      // Formato: origin|destination|waypoints|actualDays
      const parts = data.split('|');
      const origin = parts[0];
      const destination = parts[1];
      const waypointsArray = [];
      let days = parts[parts.length - 1];
      
      // Extraer paradas (todo lo entre destination y days)
      for (let i = 2; i < parts.length - 1; i++) {
        if (parts[i]) waypointsArray.push(parts[i]);
      }
      
      const drivingDays = waypointsArray.length > 0 ? 2 : 1; // Simplificado
      const restDays = parseInt(days) - drivingDays;
      
      let text = `${routeName}\n`;
      text += `Origen: ${origin}\n`;
      text += `Destino: ${destination}\n`;
      if (waypointsArray.length > 0) text += `Paradas: ${waypointsArray.join(' ‚Üí ')}\n`;
      text += `\nD√≠as totales: ${days}\n`;
      if (restDays > 0) text += `‚ö†Ô∏è Agregar ${restDays} d√≠a${restDays > 1 ? 's' : ''} de descanso en ${destination}\n`;
      
      navigator.clipboard.writeText(text).then(() => {
        alert('‚úÖ Datos copiados al portapapeles.');
      }).catch(() => {
        alert('Error al copiar. Copia manualmente los datos de la tarjeta.');
      });
    }

    function openMotorWithData(route) {
      // Construir par√°metros de URL
      const params = new URLSearchParams();
      params.set('origin', route.origin);
      params.set('destination', route.destination);
      
      // Paradas
      if (route.waypoints && route.waypoints.length > 0) {
        params.set('waypoints', route.waypoints.join('|'));
      }
      
      // D√≠as de descanso
      const restDays = Math.max(0, route.actualDays - route.stages.filter(s => s.distance > 0).length);
      if (restDays > 0) {
        params.set('restDays', restDays.toString());
      }
      
      // Abrir MOTOR con todos los par√°metros
      const url = `http://localhost:3000/motor?${params.toString()}`;
      console.log('üöÄ Abriendo MOTOR:', url);
      window.open(url, '_blank');
    }

    // Inicializar
    document.addEventListener('DOMContentLoaded', () => {
      document.getElementById('totalDistance').textContent = testData.summary.totalDistance.toFixed(0).replace(/\B(?=(\d{3})+(?!\d))/g, ",") + 'km';
      document.getElementById('totalDays').textContent = testData.summary.totalDays;
      renderRoutes();
    });
  </script>
</body>
</html>
